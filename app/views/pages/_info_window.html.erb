<div class="content-container">

  <h1 id="event-show-title">
    <%= " #{event.emoji} Let's #{Event::EMOJI.find { |k, v| v == event.emoji }.first } together!" %>
  </h1>

  <%= render "events/info_event_show_box", event: event %>

  <div class="event-show-timer">
    <div id="timer">
      <%= event.time_left %>
    </div>
    <h6>Before the beginning of the event</h6>
  </div>

  <div class="event-description-box">
    <p class="light-p">
      <%= "#{event.description}"%>
    </p>
  </div>

  <%#=  si le mec qui arrive sur la show est host j'affiche event parti %>

  <%# DISPLAY FRIENDS FOR WHO THEY'RE JOINING THE EVENT %>

  <%# IF CURRENT_USER IS THE EVENT HOST %>
  <% if current_user.user_is_host?(event) %>
    <div class="manage-event-buttons">
      <%= link_to "Share link", root_path, class: "button-medium" %>
      <%= link_to "Invite", edit_friends_event_path(event), class: "button-medium" if policy(event).edit_friends? %>
    </div>

    <%= render "events/event_users_list.html.erb", event_users: event.event_users.order_by_status %>

    <div class="container-buttons-top-bottom">
      <%= link_to "Edit plan", root_path, class: "button-next mb-2" %>
      <% if policy(event).destroy? %>
        <%= link_to "Delete my plan", event_path(event), method: :delete, data: { confirm: "Are you sure?" }, class: "button-next" %>
      <% end %>
    </div>

      <%= link_to "Edit plan", edit_event_path(event), class: "btn btn-outline-primary" %>
    </div>

  <%# IF CURRENT_USER IS A PARTNER OR A VISITOR %>
  <% else  %>

    <% if event.event_users.find_by(user: current_user).confirmed? %>
      <div class="manage-event-buttons">
        <%= link_to "Change answer", event_path(event), class: "btn btn-outline-primary" %>
        <%= link_to "Invite a friend", event_path(event), class: "btn btn-outline-secondary" if event.event_users.find_by(user: current_user).role == "partner" %>
      </div>

    <% elsif event.event_users.find_by(user: current_user).status == "pending" %>
      <%= render "events/event_users_list.html.erb", event_users: event.event_users.order_by_status %>

      <%= link_to "Join ðŸ‘Š", confirm_event_user_path(event.event_users.find_by(user: current_user)), class: "button-next btn-join mb-2" %>
      <%= link_to "Plouf ðŸ’¦", decline_event_user_path(event.event_users.find_by(user: current_user)), class: "button-next btn-plouf" %>

    <% else %>
      <%# le statut de l'event doit passer en "declined" et pas en "past"  %>
    <% end %>
  <% end  %>
</div>




























<%
=begin %>

<!-- Mapbox, app/views/flats/_info_window.html.erb -->
<div class="content-container">

  <h1 id="event-show-title">
    <%= " #{event.emoji} Let's #{Event::EMOJI.find { |k, v| v == event.emoji }.first } together!" %>
  </h1>

  <%= render "events/info_event_show_box", event: event %>

  <div class="event-show-timer">
    <div id="timer">
      <p>
        <%= event.time_left %>
      </p>
    </div>
    <h6>Before the beginning of the event</h6>
  </div>

  <div class="event-description-box">
    <p class="light-p">
      <%= "#{event.description}"%>
    </p>
  </div>

  <%#=  si le mec qui arrive sur la show est host j'affiche event parti %>

  <%# DISPLAY FRIENDS FOR WHO THEY'RE JOINING THE EVENT %>

  <%# IF CURRENT_USER IS THE EVENT HOST %>
  <% if current_user.user_is_host?(event) %>

    <%= render "events/event_users_list.html.erb", event_users: event.event_users.order_by_status %>
    <%#= link_to "Copy event link", event_path, class: "gradient-box" %>
    <%#= link_to "Manage invitations", edit_friends_event_path, class: "button-medium" if policy(event).edit_friends? %>
    <div class="manage-event-buttons">
      <% if policy(event).destroy? %>
        <%= link_to "Delete plan", event_path(event), method: :delete, data: { confirm: "Are you sure?" }, class: "button-medium" %>
      <% end %>
      <%#= link_to "Edit plan", event_path, class: "button-medium" %>
    </div>

  <%# IF CURRENT_USER IS A PARTNER OR A VISITOR %>
  <% end  %>
</div>

  <% else  %>
    <% if event.event_users.find_by(user: current_user).confirmed? %>
      <div class="manage-event-buttons">
        <%= link_to "Change answer", event_path, class: "btn btn-outline-primary" %>
        <%= link_to "Invite a friend", event_path, class: "btn btn-outline-secondary" if @current_guest.role == "partner" %>
      </div>

    <% elsif @current_guest.status == "pending" %>
      <div class="manage-event-buttons">
        <%= link_to "Decline", decline_event_user_path(@current_guest), class: "button-medium" %>
        <%= link_to "Confirm", confirm_event_user_path(@current_guest), class: "button-medium" %>
      </div>

    <% else %>
      <%# le statut de l'event doit passer en "declined" et pas en "past"  %>
    <% end %>







----------------------------- PREVIOUS POPUP VERSION -----------------------------
<h2><%= event.emoji %></h2>
<p>Address: <%= event.address %></p>

<p>Date: <%= event.date_time %></p>
<br>
<%= link_to "more", event_path(event), class: "button-next-small" %>
<br>
<br>
<p>Friends participating:</p>

   <% event.event_users.each do |event_user| %>
      <% if event_user.status == "confirmed" %>
        <p>
          <%= cl_image_tag event_user.user.avatar.key, class: "avatar-profile" %>
          <%= event_user.user.first_name %>
        </p>
      <% end %>
    <% end %>

<%
=end %>